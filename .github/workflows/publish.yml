    name: Publish Python Package to PyPI

    on:
      release:
        types: [published]

    permissions:
      id-token: write

    jobs:
      build:
        name: Build distribution ğŸ“¦
        runs-on: ubuntu-latest
        steps:
          - uses: actions/checkout@v4
          - name: Set up Python
            uses: actions/setup-python@v4
            with:
              python-version: "3.11"
          - name: Install Poetry
            run: pip install poetry
          - name: Build package
            run: poetry build
          - name: Store the distribution packages
            uses: actions/upload-artifact@v4
            with:
              name: python-package-distributions
              path: dist/

      publish-to-pypi:
        name: Publish Python ğŸ distribution ğŸ“¦ to PyPI
        needs: [build]
        runs-on: ubuntu-latest
        environment:
          name: pypi
          url: https://pypi.org/p/pymapgis
        steps:
          - name: Download all the dists
            uses: actions/download-artifact@v4
            with:
              name: python-package-distributions
              path: dist/
          - name: Publish distribution ğŸ“¦ to PyPI
            uses: pypa/gh-action-pypi-publish@release/v1